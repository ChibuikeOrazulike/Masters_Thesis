# Masters_Thesis
Series of code used in my Master's research thesis titled Characterization of aquifer dynamics at large regional scale by combining numerical simulations and remote sensing measurements.
Procedures in the process
Downloading of the GRACE MASCON DATA and ERA5-Land monthly reanalysis data: - The NetCDF file of the latest version of GRACE mascon data (CSR_GRACE_GRACE-FO_RL06_Mascons_all-corrections_v02.nc) was retrieved from database of the University of Texas Center for Space Research. Similarly, the NetCDF files of three different hydrological variables, surface runoff, snow depth water equivalent, and soil water (skin reservoir content (0 m), volumetric soil water layer 1 (0 - 7 cm), volumetric soil water layer 2 (7 -28 cm), volumetric soil water layer 3 (28-100 cm) , and volumetric soil water layer 4 (100-289 cm)) were downloaded from the Corpenicus climatic database(https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-land-monthly-means?tab=form)
Extraction of the data points from the VarKarst recharge simulation: - The latitude, longitude and recharge values from the VarKarst output were merged into a data frame and imported into QGIS environment where the shapefile of Mediterranean karst aquifers maps (https://doi.org/10.25928/MEDKAM.1) was used to clip the data points in the area of interest with their coordinate values. The monthly recharge values from the VarKarst model range from January 2003 to December 2004 and has a spatial resolution of 0.25 degrees
Extraction and Gapfilling of Storage Values from GRACE data file: - The coordinates values of the points of interest were used to extract the monthly terrestrial water storage, TWS(lwe_thickness), values ranging from January 2003 to December 2014 (same for recharge). However, the extracted GRACE data contains some missing monthly storage values (8 months) which were filled by a method of linear interpolation. A total of about 12 randomly occurring missing months (out of 144 months) were filled using the linear interpolation method (time_series_df.interpolate(method='linear', axis=1, limit_direction='both', inplace=True)).
Spatial Upscaling and Extraction of hydrological variables: - Coordinate transformation of the NetCDF files containing hydrological variables were performed followed by their spatial upscaling from their default 0.1 degrees spatial resolution to the 0.25 spatial resolution (same as VarKarst and GRACE data) using the climate data operator (CDO) software using the command prompt (cdo remapcon,<target_grid> <input_file> <output_file>). The remapcon, short for "conservative remapping," is a method used in the Climate Data Operators (CDO) tool for regridding datasets. It is based on the principle that the total value of a field is conserved during the remapping process. The conservative remapping method divides the source grid cells into fractions that contribute to the target grid cells. The value in each target cell is then calculated as the sum of the source cell values multiplied by their corresponding fractions (ie weighted average). This ensures that the total value across the entire field remains constant. The <target_grid> is the CSR GRACE mascon netCDF data which is used for resampling, the <input_file> is the netCDF file of ERA5 land monthly data while the <output_file> is
the new regridded data.. This data points of interest were then employed to extract the monthly values of each hydrological variable (surface runoff, snow water depth equivalent, and soil moisture at different depths) into a data frame.
Unit conversion of all the extracted parameters: - This step involves the unit conversion of all the hydrological parameters to from their respective units to a common unit, millimetres (mm). The surface runoff, the snow depth water equivalent, and skin reservoir content have all their values in meters and were multiplied by 1000 across their entire grids. The volumetric soil water layer 1 (0 - 7 cm), volumetric soil water layer 2 (7 -28 cm), volumetric soil water layer 3 (28-100 cm), and volumetric soil water layer 4 (100-289 cm) all have their units in m3/m3. Each layer was multiplied by its corresponding depths (7cm for layer 1, 21cm for layer 2, 72cm for layer 3, and 189cm for layer 4) and the resulting values multiplied by 10 to convert from centimetre sto millimetres. Similarly, the terrestrial water storage, TWS(lwe_thickness), from GRACE was multiplied by value of 10 to convert from default centimetre values to millimetres.
Hydrological balancing: - The Groundwater Storage, GWS values were derived from the terrestrial water storage by removing other hydrological storage components using the equation:
ΔTWS-(ΔSWE+ΔSWA+ ΔSM) = ΔGWS, where, ΔTWS is the Terrestrial Water Storage, ΔSWE is the snow water equivalent, ΔSWA is the soil water equivalent and ΔSM is the soil moisture.
Statistical Correlation and Trend analysis: - The Spearman’s correlation coefficients were obtained by correlating the GWS and VarKarst recharge time series for each grid point in the study. Also, the regression analysis was performed for each data point.
